<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SHL Assessment Recommender</title>
  <style>
    /* â”€â”€ Reset & Base â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --shl-blue:   #003087;
      --shl-teal:   #00a9ce;
      --shl-light:  #f0f7ff;
      --gray-50:    #f8fafc;
      --gray-100:   #f1f5f9;
      --gray-200:   #e2e8f0;
      --gray-500:   #64748b;
      --gray-700:   #334155;
      --gray-900:   #0f172a;
      --success:    #059669;
      --radius:     12px;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: var(--gray-50);
      color: var(--gray-900);
      min-height: 100vh;
    }

    /* â”€â”€ Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    header {
      background: linear-gradient(135deg, var(--shl-blue) 0%, #005eb8 100%);
      color: white;
      padding: 28px 40px;
      display: flex;
      align-items: center;
      gap: 20px;
      box-shadow: 0 4px 20px rgba(0,48,135,0.25);
    }

    .logo-circle {
      width: 52px; height: 52px;
      background: var(--shl-teal);
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-weight: 800; font-size: 20px; color: white;
      flex-shrink: 0;
    }

    header h1 { font-size: 1.6rem; font-weight: 700; }
    header p  { font-size: 0.9rem; opacity: 0.85; margin-top: 3px; }

    /* â”€â”€ Main Layout â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    main {
      max-width: 900px;
      margin: 0 auto;
      padding: 40px 24px;
    }

    /* â”€â”€ Input Card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .input-card {
      background: white;
      border-radius: var(--radius);
      padding: 32px;
      box-shadow: 0 2px 16px rgba(0,0,0,0.08);
      margin-bottom: 32px;
    }

    .input-card label {
      display: block;
      font-weight: 600;
      color: var(--gray-700);
      margin-bottom: 8px;
      font-size: 0.95rem;
    }

    .input-card textarea {
      width: 100%;
      min-height: 140px;
      border: 2px solid var(--gray-200);
      border-radius: 8px;
      padding: 14px 16px;
      font-size: 0.95rem;
      font-family: inherit;
      resize: vertical;
      transition: border-color 0.2s;
      color: var(--gray-900);
      line-height: 1.6;
    }

    .input-card textarea:focus {
      outline: none;
      border-color: var(--shl-teal);
    }

    .hint {
      font-size: 0.82rem;
      color: var(--gray-500);
      margin-top: 8px;
    }

    .btn-row {
      display: flex;
      gap: 12px;
      margin-top: 20px;
      align-items: center;
      flex-wrap: wrap;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--shl-blue), var(--shl-teal));
      color: white;
      border: none;
      border-radius: 8px;
      padding: 13px 32px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: opacity 0.2s, transform 0.1s;
      display: flex; align-items: center; gap: 8px;
    }

    .btn-primary:hover  { opacity: 0.92; transform: translateY(-1px); }
    .btn-primary:active { transform: translateY(0); }
    .btn-primary:disabled { opacity: 0.55; cursor: not-allowed; transform: none; }

    .btn-clear {
      background: none;
      border: 2px solid var(--gray-200);
      border-radius: 8px;
      padding: 11px 20px;
      font-size: 0.9rem;
      color: var(--gray-500);
      cursor: pointer;
      transition: border-color 0.2s, color 0.2s;
    }

    .btn-clear:hover { border-color: var(--gray-500); color: var(--gray-700); }

    /* Example queries */
    .examples { margin-top: 16px; }
    .examples-label { font-size: 0.82rem; color: var(--gray-500); margin-bottom: 8px; }
    .example-pills  { display: flex; flex-wrap: wrap; gap: 8px; }

    .pill {
      background: var(--shl-light);
      color: var(--shl-blue);
      border: 1px solid #c7d8f5;
      border-radius: 20px;
      padding: 5px 14px;
      font-size: 0.8rem;
      cursor: pointer;
      transition: background 0.15s;
    }
    .pill:hover { background: #d4e5fa; }

    /* â”€â”€ Loading â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .loader {
      display: none;
      text-align: center;
      padding: 48px 0;
    }
    .loader.visible { display: block; }

    .spinner {
      width: 48px; height: 48px;
      border: 4px solid var(--gray-200);
      border-top-color: var(--shl-teal);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin: 0 auto 16px;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* â”€â”€ Error â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .error-box {
      display: none;
      background: #fff0f0;
      border: 1px solid #fca5a5;
      border-radius: 8px;
      padding: 16px 20px;
      color: #dc2626;
      margin-bottom: 24px;
    }
    .error-box.visible { display: block; }

    /* â”€â”€ Results â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .results-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .results-header h2 {
      font-size: 1.25rem;
      color: var(--gray-700);
    }

    .badge {
      background: var(--shl-blue);
      color: white;
      border-radius: 20px;
      padding: 4px 14px;
      font-size: 0.82rem;
      font-weight: 600;
    }

    .cards-grid { display: flex; flex-direction: column; gap: 16px; }

    /* â”€â”€ Assessment Card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .card {
      background: white;
      border-radius: var(--radius);
      padding: 24px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.06);
      border-left: 4px solid var(--shl-teal);
      transition: box-shadow 0.2s, transform 0.2s;
      animation: fadeIn 0.3s ease both;
    }

    .card:nth-child(2)  { animation-delay: 0.05s; }
    .card:nth-child(3)  { animation-delay: 0.10s; }
    .card:nth-child(4)  { animation-delay: 0.15s; }
    .card:nth-child(5)  { animation-delay: 0.20s; }
    .card:nth-child(6)  { animation-delay: 0.25s; }
    .card:nth-child(7)  { animation-delay: 0.30s; }
    .card:nth-child(8)  { animation-delay: 0.35s; }
    .card:nth-child(9)  { animation-delay: 0.40s; }
    .card:nth-child(10) { animation-delay: 0.45s; }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(12px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    .card:hover {
      box-shadow: 0 6px 24px rgba(0,48,135,0.12);
      transform: translateY(-2px);
    }

    .card-number {
      font-size: 0.78rem;
      font-weight: 700;
      color: var(--shl-teal);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 6px;
    }

    .card-title {
      font-size: 1.05rem;
      font-weight: 700;
      color: var(--shl-blue);
      text-decoration: none;
      display: block;
      margin-bottom: 10px;
    }
    .card-title:hover { text-decoration: underline; }

    .card-desc {
      font-size: 0.88rem;
      color: var(--gray-500);
      line-height: 1.6;
      margin-bottom: 14px;
    }

    .card-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }

    .tag {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      border-radius: 6px;
      padding: 3px 10px;
      font-size: 0.78rem;
      font-weight: 600;
    }

    .tag-type     { background: #eff6ff; color: #1d4ed8; }
    .tag-remote   { background: #f0fdf4; color: #15803d; }
    .tag-adaptive { background: #fdf4ff; color: #7e22ce; }
    .tag-duration { background: #fff7ed; color: #c2410c; }

    /* â”€â”€ Footer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    footer {
      text-align: center;
      padding: 24px;
      color: var(--gray-500);
      font-size: 0.82rem;
    }

    /* â”€â”€ Responsive â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @media (max-width: 600px) {
      header { padding: 20px; }
      main   { padding: 24px 16px; }
      .input-card { padding: 20px; }
    }
  </style>
</head>
<body>

<header>
  <div class="logo-circle">SHL</div>
  <div>
    <h1>Assessment Recommender</h1>
    <p>Find the right SHL assessments for any role â€” powered by AI</p>
  </div>
</header>

<main>
  <!-- Input Card -->
  <div class="input-card">
    <label for="query-input">Job Description or Natural Language Query</label>
    <textarea
      id="query-input"
      placeholder="e.g. I need to hire a Java developer who can collaborate with cross-functional teams and stakeholders..."
    ></textarea>
    <p class="hint">
      ğŸ’¡ You can paste a job description, describe the role in plain English, or enter a URL to a job posting.
    </p>

    <div class="btn-row">
      <button class="btn-primary" id="search-btn" onclick="getRecommendations()">
        <svg width="16" height="16" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
          <circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/>
        </svg>
        Find Assessments
      </button>
      <button class="btn-clear" onclick="clearAll()">Clear</button>
    </div>

    <!-- Example queries -->
    <div class="examples">
      <p class="examples-label">Try an example:</p>
      <div class="example-pills">
        <span class="pill" onclick="setExample(this)">Java developer with collaboration skills</span>
        <span class="pill" onclick="setExample(this)">Python, SQL, JavaScript mid-level professional</span>
        <span class="pill" onclick="setExample(this)">Cognitive and personality tests for analyst role</span>
        <span class="pill" onclick="setExample(this)">Sales manager with leadership and customer focus</span>
      </div>
    </div>
  </div>

  <!-- Error -->
  <div class="error-box" id="error-box"></div>

  <!-- Loading -->
  <div class="loader" id="loader">
    <div class="spinner"></div>
    <p style="color: var(--gray-500); font-size: 0.95rem;">Finding the best assessments for youâ€¦</p>
  </div>

  <!-- Results -->
  <div id="results-section" style="display:none;">
    <div class="results-header">
      <h2>Recommended Assessments</h2>
      <span class="badge" id="results-count"></span>
    </div>
    <div class="cards-grid" id="cards-container"></div>
  </div>
</main>

<footer>
  SHL Assessment Recommendation System &nbsp;|&nbsp; Powered by Gemini + ChromaDB
</footer>

<script>
  // â”€â”€ Config â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const API_BASE = "http://localhost:8000";   // Change to your deployed URL

  // â”€â”€ DOM refs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const input    = document.getElementById("query-input");
  const loader   = document.getElementById("loader");
  const errorBox = document.getElementById("error-box");
  const results  = document.getElementById("results-section");
  const cards    = document.getElementById("cards-container");
  const countBadge = document.getElementById("results-count");
  const searchBtn  = document.getElementById("search-btn");

  // â”€â”€ Example queries â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function setExample(el) {
    const examples = {
      "Java developer with collaboration skills":
        "I am hiring for Java developers who can also collaborate effectively with my business teams and external stakeholders.",
      "Python, SQL, JavaScript mid-level professional":
        "Looking to hire mid-level professionals who are proficient in Python, SQL and JavaScript.",
      "Cognitive and personality tests for analyst role":
        "I am hiring for an analyst role and want to screen applicants using Cognitive and personality tests.",
      "Sales manager with leadership and customer focus":
        "Looking for a Sales Manager who demonstrates strong leadership, customer relationship management, and the ability to drive revenue growth.",
    };
    input.value = examples[el.textContent.trim()] || el.textContent.trim();
    input.focus();
  }

  function clearAll() {
    input.value = "";
    results.style.display = "none";
    errorBox.classList.remove("visible");
    cards.innerHTML = "";
    input.focus();
  }

  // â”€â”€ API call â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  async function getRecommendations() {
    const query = input.value.trim();
    if (!query) {
      input.focus();
      return;
    }

    // Show loading
    loader.classList.add("visible");
    results.style.display = "none";
    errorBox.classList.remove("visible");
    searchBtn.disabled = true;
    cards.innerHTML = "";

    try {
      const resp = await fetch(`${API_BASE}/recommend`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ query }),
      });

      if (!resp.ok) {
        const err = await resp.json().catch(() => ({}));
        throw new Error(err.detail || `HTTP ${resp.status}`);
      }

      const data = await resp.json();
      const assessments = data.recommended_assessments || [];

      if (!assessments.length) {
        throw new Error("No assessments returned. Try a different query.");
      }

      renderCards(assessments);

    } catch (err) {
      showError(err.message);
    } finally {
      loader.classList.remove("visible");
      searchBtn.disabled = false;
    }
  }

  // â”€â”€ Render â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function renderCards(assessments) {
    cards.innerHTML = "";
    countBadge.textContent = `${assessments.length} found`;

    assessments.forEach((a, idx) => {
      const card = document.createElement("div");
      card.className = "card";

      // Test type tags
      const typeTags = (a.test_type || []).map(t =>
        `<span class="tag tag-type">${t}</span>`
      ).join("");

      // Remote / adaptive / duration tags
      const remoteTag   = a.remote_support === "Yes"
        ? `<span class="tag tag-remote">âœ“ Remote</span>` : "";
      const adaptiveTag = a.adaptive_support === "Yes"
        ? `<span class="tag tag-adaptive">âœ“ Adaptive</span>` : "";
      const durTag      = a.duration
        ? `<span class="tag tag-duration">â± ${a.duration} min</span>` : "";

      const desc = a.description
        ? `<p class="card-desc">${truncate(a.description, 180)}</p>`
        : "";

      card.innerHTML = `
        <div class="card-number">Assessment #${idx + 1}</div>
        <a class="card-title" href="${a.url}" target="_blank" rel="noopener">
          ${escapeHTML(a.name)}
        </a>
        ${desc}
        <div class="card-meta">
          ${typeTags}
          ${remoteTag}
          ${adaptiveTag}
          ${durTag}
        </div>
      `;
      cards.appendChild(card);
    });

    results.style.display = "block";
    results.scrollIntoView({ behavior: "smooth", block: "start" });
  }

  function showError(msg) {
    errorBox.textContent = `âš ï¸  ${msg}`;
    errorBox.classList.add("visible");
  }

  // â”€â”€ Utils â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function truncate(str, n) {
    return str.length > n ? str.slice(0, n) + "â€¦" : str;
  }

  function escapeHTML(str) {
    const d = document.createElement("div");
    d.appendChild(document.createTextNode(str));
    return d.innerHTML;
  }

  // Allow Ctrl+Enter / Cmd+Enter to submit
  input.addEventListener("keydown", e => {
    if ((e.ctrlKey || e.metaKey) && e.key === "Enter") getRecommendations();
  });
</script>

</body>
</html>